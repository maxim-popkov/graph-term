Коваленко Д.С., Костенко В.А., Щербинин В.В. Параметрическое семейство алгоритмов распознавания нелинейно искаженных фазовых траекторий динамических систем // XIV Всероссийская научно-техническая конференция "Нейроинформатика-2012". Сборник научных трудов. - М.: НИЯУ МИФИ, 2012. - Ч.1 – С.266-276.

Д.С. КОВАЛЕНКО, В.А. КОСТЕНКО, В.В. ЩЕРБИНИН
МГУ им. М.В. Ломоносова
victorshch@gmail.com

ПАРАМЕТРИЧЕСКОЕ СЕМЕЙСТВО АЛГОРИТМОВ РАСПОЗНАВАНИЯ НЕЛИНЕЙНО ИСКАЖЕННЫХ ФАЗОВЫХ ТРАЕКТОРИЙ ДИНАМИЧЕСКИХ СИСТЕМ

Рассматривается задача построения по обучающей выборке алгоритмов распознавания участков нештатного поведения динамических систем в фазовых траекториях системы. Участки нештатного поведения системы могут быть нелинейно искажены по амплитуде и по времени друг относительно друга в различных условиях работы системы. Предложены параметрическое семейство алгоритмов распознавания и метод построения алгоритмов распознавания, обладающих большей устойчивостью к искажениям фазовых траекторий по сравнению с известными методами.

Ключевые слова: задача обучения по прецедентам, алгоритм распо­знавания, обучающая выборка, алгоритм обучения, динамическая си­стема, алгебраический подход к задаче выделения трендов.

Введение
Рассматриваются системы, информация о поведении которых доступна в виде фазовых траекторий, в пространстве показаний датчиков системы. Время рассматривается дискретное, датчики опрашиваются с некоторой фиксированной частотой . Фазовая траектория  в пространстве показаний датчиков представляет собой набор последовательных измерений показаний датчиков системы: , где:  – это точка в многомерном фазовом пространстве показаний датчиков.
Состояние системы характеризуется точкой фазовой траектории. Со временем система изменяет свое состояние, последовательные изменения состояния системы будем называть ее поведением. Существует три типа  состояний системы: 
штатное состояние, при котором система стабильно выполняет заложенные в нее функции;
нештатное состояние, при котором система в скором времени гарантированно перестанет выполнять заложенные в нее функции;
аварийное состояние, при котором система не выполняет заложенных в нее функций.
Нормальным поведением системы будем называть такое поведение, при котором все состояния, которые принимает система, являются штатными. Нештатным поведением системы будем называть такое, при котором все состояния, которые принимает система, являются нештатными. Считаем, что каждому аварийному состоянию системы предшествует нештатное поведение. Может существовать несколько классов нештатного поведения, которые соответствуют различными неисправностями, приводящих к аварийному состоянию системы. 
Будем считать, что для каждого класса нештатного поведения существует некоторая характерная фазовая траектория , такие траектории будем называть эталонными. Пусть число классов нештатного поведения системы равно . Пусть  – множество ответов, где  соответствует штатному поведению системы,  соответствует нештатному поведению класса номер  из  возможных.
Участки нештатного поведения могут входить в анализируемую фазовую траекторию  в искаженном относительно эталонных траекторий виде. Можно выделить следующие типы искажений: искажения по амплитуде и искажения по времени. Под искажением траектории по амплитуде будем понимать изменение значений точек траектории без изменения числа отсчетов. Под искажением траектории по времени будем понимать изменение числа отсчетов, на которых определена траектория, то есть добавление в траекторию новых отсчетов или удаление из нее уже существующих. На рис. 1 показаны траектории, которые искажены по амплитуде и времени друг относительно друга. Подклассом искажений по амплитуде можно считать стационарный шум, возникающий в датчиках, окружающих систему.
Задача распознавания нештатного поведения состоит в следующем. Дано:  
наблюдаемая многомерная траектория ;
набор из  классов нештатного поведения системы, для каждого из которых задана эталонная траектория ;
ограничения на полноту и точность распознавания: ,, где  – число ошибок распознавания первого рода,  – число ошибок распознавания второго рода, ,  – заданные числовые ограничения. 
 Требуется с учетом ограничений на полноту и точность провести распознавание нештатного поведения в работе системы, т. е. указать в наблюдаемой траектории  участки нештатного поведения и номер класса нештатного поведения для каждого указанного участка.

Параметрическое семейство алгоритмов распознавания
Разработанное семейство алгоритмов распознавания основано на идеях алгебраического подхода к разметке плоских конфигураций. Идея использования алгебраического подхода для выделения трендов на временных рядах была предложена в работе [1], в работе [2] было предложено использование этого подхода для обнаружения нештатных режимов работы динамических систем. Основой аксиоматического подхода является разметка анализируемой траектории аксиомами и анализ траектории по полученному ряду разметки.
Определение 1. Элементарное условие  – это функция, определенная на отчете  и некоторой его окрестности  на траектории , зависящая от набора параметров , которая принимает значения из множества .
Пример элементарного условия: 
       (1)
 где , .
Определение 2. Аксиома  – это функция, заданная в виде булевой формулы от элементарных условий, определенных на отсчете  и некоторой его окрестности  на траектории :  
		(2)
  где  
Определение 3. Конечное множество аксиом  будем называть системой аксиом, если оно удовлетворяет условию:  
		(3)
т.е. для любой точки  произвольной фазовой траектории  найдется и притом только одна аксиома  из множества , условия которой выполняются в данной точке.
Любое множество аксиом возможно представить в виде системы аксиом выполнив: 
1. Введение порядка на множестве аксиом. Пронумеруем аксиомы в системе аксиом последовательными натуральными числами:
	(4)
Будем считать что, если аксиома с индексом  выполняется в некоторой точке произвольной фазовой траектории, то никакая аксиома с индексом  не выполняется в данной точке траектории.
2. Добавление тождественной аксиомы с наименьшим приоритетом в систему аксиом :  
		(5)
Тождественная аксиома  – это аксиома, которая выполняется в любой точке любой фазовой траектории.
Определение 4. Разметкой траектории  системой аксиом  будем называть конечную последовательность , где  – индекс аксиомы в системе аксиом , условия которой выполняются на отсчете  траектории . 
 Алгоритм, сопоставляющий траектории ее разметку заданной системой аксиом, будем называть алгоритмом разметки и обозначать .
В рамках разработанного подхода распознавание нештатного поведения в работе наблюдаемой системы происходит следующим образом:  
1. Размечаются эталонные траектории , соответствующие различным классам нештатного поведения. 
2. Размечается наблюдаемая траектория  и формируется ряд разметки . 
3. В ряду разметки  ищутся подпоследовательности номеров аксиом, соответствующие разметкам эталонных траекторий. 
Таким образом, определение нештатного поведения в работе наблюдаемой системы ведется не путем поиска эталонных траекторий  в наблюдаемой траектории , а путем поиска разметок эталонных траекторий в ряду разметки .
Решение рассматриваемой задачи распознавания будем искать среди множества алгоритмов , каждый из которых включает в себя:  
алгоритм предобработки исходных данных, 
алгоритм разметки и систему аксиом, 
алгоритм поиска разметок эталонных траекторий в разметке наблюдаемой траектории. 
Алгоритм предобработки включен в состав алгоритма распознавания с целью уменьшения влияния шумовых составляющих наблюдаемой траектории на качество распознавания. Использование алгоритмов нечеткого поиска разметок позволяет бороться с искажениями по времени. Для предобработки использовались следующие алгоритмы: сглаживания, сжатия и интерполяции траектории на произвольный коэффициент, быстрое преобразование Фурье. Для поиска разметок использовались: алгоритмы на основе метрики Минковского и DTW (Dynamic Time Warping) [3], алгоритмы на основе нейросетей, кроме этого был предложен алгоритм на основе расширенных разметок [4].

Задача построения алгоритма распознавания нештатного поведения
Пусть задан набор прецедентов  в виде экземпляров траекторий , полученных в различных условиях работы системы. Траектории  из набора  содержат как участки нештатного поведения, так и участки нормального поведения. Будем рассматривать два случая:
1. Для траекторий из набора  указаны границы участков нештатного поведения и для каждого из указанных участков указан номер класса нештатного поведения из множества . В этом случае набор прецедентов  называется набором прецедентов с указанием участков нештатного поведения.
2. Для траекторий из  указаны точки наступления аварийных ситуаций (при этом отсчеты начала и окончания предшествующего участка нештатного поведения неизвестны, т.е. неизвестна точка возникновения неисправности в системе). Для каждой точки аварии указан номер класса нештатного поведения из множества . В этом случае набор прецедентов  называется набором прецедентов с указанием точек аварий. 
Будем считать, что набор прецедентов  разделен на 2 равные непересекающиеся части: обучающую выборка  и контрольную выборка . Такое разделение обусловлено необходимостью использования обучающей выборки  для построения алгоритма распознавания и использования контрольной выборки  для оценки качества работы построенного алгоритма. Будем считать, что заданные наборы прецедентов ,  являются представительными, т. е. содержат как участки нормального поведения, так и участки нештатного поведения с различными искажениями, полученные в различных условиях работы системы.
 Пусть задана целевая функция , где  и  – число ошибок распознавания первого и второго рода, которая отвечает следующим требованиям:  
функция  определена для любых неотрицательных целых значений аргументов  и ;
функция  монотонно неубывает по каждому из аргументов. 
Число ошибок распознавания первого рода  (второго рода ) определяется для некоторого алгоритма распознавания  на некоторой траектории . Под числом ошибок распознавания на выборке  будем понимать сумму числа ошибок распознавания на всех траекториях данной выборки.
Задача построения алгоритма распознавания нештатных ситуаций в работе динамической системы состоит в следующем. Дано:  
выборка , 
целевая функция . 
 Требуется построить алгоритм распознавания , который будет удовлетворять следующему набору ограничений:  
1. Алгоритм  должен выдавать ограниченное число ошибок на обучающей выборке : 
, 	(6)
где:  – заданные  числовые ограничения.
2. Алгоритм  должен минимизировать значение целевой функции  на контрольной выборке : 
	(7)
3. Вычислительная сложность работы алгоритма распознавания  на произвольной траектории, длины не больше , должна быть ограничена наперед заданной функцией , которая определяется характеристиками используемого вычислителя и скоростью развития процессов в анализируемой системе: 
	(8)
Данная задача построения алгоритма распознавания соответствует классической постановке задачи обучения по прецедентам [5]. 

Методы обучения параметрического семейства алгоритмов распознавания
Для того, чтобы найти требуемый алгоритм распознавания в семействе , необходимо выбрать алгоритм предобработки и значение его параметров, построить систему аксиом, выбрать алгоритм нечеткого поиска и значение его параметров, а также определить эталоны участков нештатного поведения, которые необходимо обнаруживать в наблюдаемой фазовой траектории системы. Поиск алгоритма распознавания ведется в два этапа:  
1. Для каждой пары (алгоритм предобработки, алгоритм поиска разметок) ведется поиск алгоритма распознавания, при котором настраиваются значения параметров заданных алгоритмов предобработки и поиска разметок, стоится система аксиом и формируются разметки участков нештатного поведения. Область поиска с заданным типом алгоритма предобработки и типом алгоритма поиска разметок будем называть шаблоном и обозначать .
2. Среди всех полученных решений выбирается то, которое показывает наименьшее значение целевой функции  на контрольной выборке . 
 Для настройки параметров алгоритмов предобработки и поиска разметок используются алгоритмы локальной оптимизации, например, алгоритм градиентного спуска. Наибольшую сложность представляет задача построения системы аксиом.
В случае набора прецедентов с указанием участков нештатного поведения построение системы аксиом ведется при помощи генетического алгоритма [6]. Основные этапы алгоритма:
1. Создание начальной популяции.
2. Мутация особей популяции.
3. Скрещивание особей и образование расширенной популяции.
4. Селекция особей и сужение популяции.
5. Проверка критерия останова: останов или переход к п. 2.
Особью популяции является система аксиом. Операции мутации и скрещивания определены на трех уровнях: уровне систем аксиом, уровне аксиом и уровне элементарных условий. Селекция ведется на основе результатов вычисления целевой функции  для каждой системы аксиом в популяции на контрольной выборке . При этом разметки эталонных траекторий строятся как разметки участков нештатного поведения из обучающей выборки ; если для некоторого класса нештатного поведения в обучающей выборке задано несколько участков нештатного поведения, то из их разметок выбирается та, которая показывает наименьшее значение целевой функции на контрольной выборке .
В случае набора прецедентов с указанием точек аварий набор прецедентов  преобразуется следующим образом: для каждой траектории :
если не содержит точек аварий, то она оставляется без изменений;
если содержит точки аварии, то участки длины с правым концом в точках аварии и оставшиеся участки добавляются в  как отдельные траектории, а траектория удаляется из .
Здесь  – параметр, определяемый тем, как скоро в системе после проявления нештатного поведения наступает авария, и зависящий от конкретной динамической системы.
В результате такого преобразования в наборе прецедентов остаются траектории, каждая из которых содержит не более одного участка нештатного поведения, для которого известен номер класса нештатного поведения, но неизвестно конкретное положение в траектории.
Построение системы аксиом и разметок эталонных траекторий проводится при помощи алгоритма, использующего направленный перебор [7]. Основные этапы алгоритма:
1. Подбор элементарных условий. На этом этапе ведется перебор типов и параметров элементарных условий и отбор заданного числа элементарных условий, которые чаще встречаются на траекториях, содержащих участки нештатного поведения и реже – на траекториях нормального поведения обучающей выборки.
2. Подбор аксиом. На этом этапе происходит итеративное объединение элементарных условий, полученных на предыдущем этапе, в аксиомы при помощи операторов конъюнкции и дизъюнкции. Затем отбирается заданное число аксиом, которые чаще встречаются на траекториях обучающей выборки, содержащих участки нештатного поведения и реже – на траекториях нормального поведения.
3. Подбор систем аксиом. На этом этапе системы аксиом итеративно строятся из аксиом, полученных на предыдущем этапе. Затем выбираются лучшие системы аксиом, имеющие наименьшее значение целевой функции  на контрольной выборке. 
Первые два этапа проводятся независимо для каждого класса нештатного поведения. На третьем этапе для каждой системы аксиом разметки эталонных траекторий каждого класса нештатного поведения формируются как наибольшие общие подпоследовательности разметок траекторий, содержащих участки нештатного поведения этого класса.

Заключение
При численном исследовании предложенного метода построения распознавателя для случая набора прецедентов с указанием участков нештатного поведения на модельных данных при искажениях эталонных траекторий по времени до 40% и амплитуде налагаемого шума до 25% число ложных срабатываний не превысило 76 на траекториях длиной 30000 отсчетов, а процент нераспознанных участков нештатного поведения был равен 2%. При применении подхода к прогнозирования микрона водителя в среднем процент ошибок II рода составил 5%, а число ложных срабатываний в среднем составило около 15 на отсчетов (что соответствует 6–7 часам наблюдения).
При численном исследовании предложенного метода построения распознавателя для случая набора прецедентов с указанием точек аварий на модельных данных при искажениях по времени до 50% и по амплитуде до 20% число ложных срабатываний не превысило 18 на траекториях длиной 10000 отсчетов, а процент нераспознанных участков нештатного поведения не превышал 5%. Для задачи распознавания рукописного ввода букв число корректно распознанных букв составило 95%, число ложных срабатываний – 58 при общем числе траекторий 2858.
Результаты численного исследования свидетельствуют о том, что разработанные методы построения алгоритмов распознавания позволяют получать алгоритмы, обладающие высокой устойчивостью к нелинейным искажениям фазовых траекторий нештатного поведения. Кроме этого, разработанные методы, в отличие от известных методов, основанных на машинном обучении, позволяют строить алгоритмы распознавания нештатного поведения систем для случая, когда время возникновения неисправности в системе неизвестно, т. е. в траекториях обучающей выборки не указаны участки нештатного поведения, а указана лишь точка наступления аварии.

Список литературы

1. Рудаков К.В., Чехович Ю.В. О проблеме синтеза обучающих алгоритмов выделения трендов (алгебраический подход). // Прикладная математика и информатика N 8, М. Издательство факультета ВМиК МГУ, 2001. С. 97-114. 
2. Коваленко Д.С., Костенко В.А., Васин Е.А. Исследование применимости алгебраического подхода к анализу временных рядов. // Труды Второй Всероссийской Научной Конференции «Методы и средства обработки информации». Изд.: ВМиК МГУ, 2005. С. 553-559. 
3. Keogh E. J., Michael J. Pazzani. Derivative Dynamic Time Warping. // Proceedings of the First SIAM International Conference on Data Mining (SDM'2001), Chicago, USA. 2001. http://www.ics.uci.edu/pazzani/Publications/sdm01.pdf. 
4. Коваленко Д.С. Методы нечеткого сравнения и голосования для построения распознавателей нештатного поведения динамических систем.  // Труды V Московской международной конференции по исследованию операций «ORM-2007». Изд: МАКС Пресс, 2007. С.123-125. 
5. Воронцов К.В. Комбинаторный подход к оценке качества обучаемых алгоритмов. // Математические вопросы кибернетики. №13, 2004. С.5-36.
6. Коваленко Д.С., Костенко В.А., Васин Е.А. Генетический алгоритм построения системы аксиом для разметки временных рядов. // Труды VII Международной Конференции: Дискретные модели в теории управляющих систем. М.: Макс Пресс, 2006. С. 46-54.
7. Коваленко Д.С. Метод автоматического построения алгоритмов распознавания участков фазовых траекторий. // Моделирование и анализ информационных систем, Т. 16, №4, 2009. Изд.: ЯрГУ. С. 6–21.