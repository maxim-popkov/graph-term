В.А. Костенко, Д.С. Коваленко. Алгоритмы распознавания нештатного поведения динамических систем устойчивые к нелинейным искажениям фазовых траекторий системы // Труды Международной научно-практической конференции "Передовые информационные технологии, средства и системы автоматизации и их внедрение на российских предприятиях" AITA-2011. – М.: Институт проблем управления им. В. А. Трапезникова РАН, 2011. – С.897–905.

УДК 004.02+004.67

АЛГОРИТМЫ РАСПОЗНАВАНИЯ НЕШТАТНОГО ПОВЕДЕНИЯ ДИНАМИЧЕСКИХ СИСТЕМ УСТОЙЧИВЫЕ К НЕЛИНЕЙНЫМ ИСКАЖЕНИЯМ ФАЗОВЫХ ТРАЕКТОРИЙ СИСТЕМЫ

Д.С. Коваленко
МГУ им. М.В. Ломоносова
Россия, 119991, Москва, Ленинские горы, 
МГУ, 2-й Учебный Корпус, факультет ВМК
E-mail: dk@lvk.cs.msu.su 

В.А. Костенко
МГУ им. М.В. Ломоносова
Россия, 119991, Москва, Ленинские горы, 
МГУ, 2-й Учебный Корпус, факультет ВМК
E-mail: kost@cs.msu.su 

Ключевые слова: задача обучения по прецедентам, алгоритм распознавания, обучающая выборка, алгоритм обучения, динамическая система, алгебраический подход к задаче выделения трендов.

В данной работе рассматривается задача автоматического построения алгоритмов распознавания нештатного поведения динамических систем. Информация о поведении системы доступна в виде фазовой траектории в пространстве показаний датчиков. Особенностью рассматриваемой задачи распознавания является то, что в наблюдаемой фазовой траектории участки, соответствующие нештатному поведению системы, могут быть нелинейно искажены по амплитуде и растянуты или сжаты по времени друг относительно друга в различных условиях работы системы. В работе предложены параметрическое семейство алгоритмов и метод построения по обучающей выборке алгоритмов распознавания нештатного поведения динамических систем обладащих более высокой устойчивостью к искажениям фазовых траекторий по сравнени. с известными методами.


1. Задача распознавания нештатного поведения динамических систем

Рассматриваются системы, информация о поведении которых доступна в виде фазовых траекторий, получаемых с окружающих систему датчиков. Время рассматривается дискретное, датчики опрашиваются с некоторой фиксированной частотой . Фазовая траектория  в пространстве показаний датчиков представляет собой последовательные измерения всех датчиков системы: , где:  – это точка в многомерном пространстве показаний датчиков (в фазовой плоскости).
Состояние системы характеризуется точкой фазовой траектории. Со временем система изменяет свое состояние, последовательные изменения состояния системы будем называть ее поведением. Существует три класса состояний системы: 
штатное состояние, при котором система стабильно выполняет заложенные в нее функции;
нештатное состояние, при котором система в скором времени гарантированно перестанет выполнять заложенные в нее функции;
аварийное состояние, при котором система не выполняет заложенных в нее функций.
Нормальным поведением системы будем называть такое поведение, при котором все состояния, которые принимает система, принадлежат классу штатных состояний. Нештатным поведением системы будем называть такое, при котором все состояния, которые принимает система, принадлежат классу нештатных состояний. Считаем, что каждому аварийному состоянию системы предшествует нештатное поведение. Может существовать несколько классов нештатного поведения, приводящих к аварийному состоянию системы. Классы нештатного поведения определяются различными неисправностями, которые могут возникнуть в рассматриваемой системе. 
Будем считать, что для каждого класса нештатного поведения существует некоторая характерная фазовая траектория , такие траектории будем называть эталонными. Пусть число классов нештатного поведения системы равно . Обозначим:  – множество ответов, где  – соответствует штатному поведению системы,  – соответствует нештатному поведению под номером  из  возможных.
Участки нештатного поведения могут входить в анализируемую фазовую траекторию  в искаженном относительно эталонных траекторий виде. Можно выделить следующие типы искажений: искажения по амплитуде и искажения по времени. Под искажением траектории по амплитуде будем понимать изменение абсолютных значений точек траектории, без изменения числа отсчетов. Под искажением траектории по времени будем понимать изменение числа отсчетов, на которых определена траектория, то есть добавление в траекторию новых отсчетов или удаление из нее уже существующих. На рис. 1 показаны траектории, которые искажены по амплитуде и времени друг относительно друга. Подклассом искажений по амплитуде можно считать стационарный шум, возникающий в датчиках, окружающих систему.



Рис. 1. Пример искаженных друг относительно друга траекторий по амплитуде и времени.
  
Задача распознавания нештатного поведения состоит в следующем. Дано:  
наблюдаемая многомерная траектория ;
набор из  классов нештатного поведения системы, для каждого из которых задана эталонная траектория ;
ограничения на полноту и точность распознавания: 
	
где:  – число ошибок распознавания первого рода;  – число ошибок распознавания второго рода; ,  – заданные числовые ограничения. 
 Требуется с учетом ограничений на полноту и точность провести распознавание нештатного поведения в работе системы.


2. Параметрическое семейство алгоритмов распознавания

Разработанное семейство алгоритмов распознавания основано на идеях алгебраического подхода к разметке плоских конфигураций. Идея использования аксиоматического подхода для выделения трендов на временных рядах была предложена в работе [1], в работе [2] было предложено использование этого подхода для обнаружения нештатных режимов работы динамических систем. Основой аксиоматического подхода является разметка анализируемой траектории аксиомами и анализ траектории по полученному ряду разметки.
Определение 1: Элементарное условие  – это функция, определенная на отчете  и некоторой его окрестности  на траектории , зависящая от набора параметров , которая принимает значения из множества . 
Пример элементарного условия: 
		
 где: ; .
Определение 2: Аксиома  – это булева функция, заданная в виде формулы от элементарных условий, определенных на отсчете  и некоторой его окрестности  на траектории :  
		
  где:  
	 
Определение 3: Конечное множество аксиом  будем называть системой аксиом, если оно удовлетворяет условию:  
	
т.е. для любой точки  произвольной фазовой траектории  найдется и притом только одна аксиома  из множества , условия которой выполняются в данной точке.
Далее будем считать, что аксиомы в системе аксиом  пронумерованы последовательными натуральными числами: .
Любое множество аксиом возможно представить в виде системы аксиом выполнив: 
1. Введение порядка на множестве аксиом. Будем считать что, если аксиома с индексом  выполняется в некоторой точке произвольной фазовой траектории, то никакая аксиома с индексом  не выполняется в данной точке траектории.
2. Добавление тождественной аксиомы  в  с наименьшим приоритетом:  
	
Тождественная аксиома  – это аксиома, которая выполняется в любой точке любой фазовой траектории.
Определение 4: Разметкой траектории  относительно системы аксиом  будем называть последовательность , где  – индекс аксиомы в системе аксиом , условия которой выполняются на отсчете  траектории . 
 Алгоритм, который сопоставляет траектории  ее разметку относительно заданной системы аксиом, будем называть алгоритмом разметки и обозначать: .
В рамках разработанного подхода распознавание нештатного поведения в работе наблюдаемой системы происходит следующим образом:  
1. Размечаются эталонные траектории , соответствующие различным классам нештатного поведения. 
2. Размечается наблюдаемая траектория  и формируется ряд разметки . 
3. В ряду разметки  ищутся подпоследовательности номеров аксиом соответствующие разметкам эталонных траекторий. 
Таким образом, определение нештатного поведения в работе наблюдаемой системы ведется не путем поиска эталонных траекторий  в наблюдаемой траектории , а путем поиска разметок эталонных траекторий в ряду разметки .
Решение рассматриваемой задачи распознавания будем искать среди множества алгоритмов , каждый из которых включает в себя:  
алгоритм предобработки исходных данных, 
алгоритм разметки и система аксиом, 
алгоритм поиска разметок эталонных траекторий в разметке наблюдаемой траектории. 
Алгоритм предобработки включен в состав алгоритма распознавания с целью уменьшения влияния шумовых составляющих наблюдаемой траектории на качество распознавания. Использование алгоритмов нечеткого поиска разметок позволяет бороться с искажениями по времени. Для предобработки использовались следующие алгоритмы: сглаживания, сжатия и интерполяции траектории на произвольный коэффициент, быстрое преобразование Фурье. Для поиска разметок использовались: алгоритмы на основе метрики Минковского и DTW (Dynamic Time Warping) [3], алгоритмы на основе нейросетей, кроме того был предложен алгоритм на основе расширенных разметок [4].


3. Задача построения алгоритма распознавания по обучающей выборке

Пусть задан набор прецедентов  в виде экземпляров траекторий , полученных в различных условиях работы системы. Траектории  из набора  содержат как участки нештатного поведения, так и участки нормального поведения. Для каждой из траектории  указаны:  
точки наступления аварийных ситуаций (при этом отсчеты начала и окончания предшествующего участка нештатного поведения неизвестны, т.е. неизвестна точка возникновения неисправности в системе); 
для каждой аварийной ситуации указан ее тип из множества . 
Преобразуем всю известную выборку  следующим образом.  Каждая траектория , содержащую точку аварии, разделяется на части: траектория нормального поведения  и траектория  длиной  отсчетов, содержащая участок нештатного поведения ( - параметр преобразования). Траектория  представляет собой участок траектории  с отсчета  по отсчет , где  – это точка аварии на траектории . После преобразований выборка  представляет собой набор траекторий: . Часть из них является траекториями нормального поведения , другая часть  – это набор таких траекторий, каждая из которых содержит участок нештатного поведения, однако не известно на каких именно отсчетах. Далее, будем считать, что выборка  преобразована указанным образом.
Разделим всю преобразованную выборку  на  равные непересекающиеся части: выборка  для определения разметок участков нештатного поведения, обучающая выборка  и контрольная выборка . При этом в каждую из выделенных частей должны попасть траектории из наборов ,  в одинаковом соотношении. Такое разделение выборки обусловлено необходимостью выделения выборки  для определения разметок эталонных траекторий, необходимостью использования выборки  для построения системы аксиом  и необходимостью использования контрольной выборки  для оценки качества работы полученного алгоритма распознавания.
Пусть определена целевая функция , где  и  – число ошибок распознавания первого и второго рода, которая отвечает следующим требованиям:  
функция  определена для любых неотрицательных целых значений аргументов  и ;
функция  монотонно неубывает по каждому из аргументов. 
Число ошибок распознавания первого рода  (второго рода ) определяется для некоторого алгоритма распознавания  на некоторой траектории . Под числом ошибок распознавания на выборке  будем понимать сумму ошибок распознавания на всех траекториях данной выборки.
Задача построения алгоритма распознавания нештатных ситуаций в работе динамической системы состоит в следующем. Дано:  
выборка , 
целевая функция . 
 Требуется построить алгоритм распознавания , который будет удовлетворять следующему набору ограничений:  
1. Алгоритм  должен выдавать ограниченное число ошибок на обучающей выборке : 
	, 
где:  – заданные  числовые ограничения.
2. Алгоритм  должен минимизировать значение целевой функции  на контрольной выборке : 
	
3. Вычислительная сложность работы алгоритма распознавания  на произвольной траектории, длины не больше , должна быть ограничена наперед заданной функцией , которая определяется характеристиками используемого вычислителя и скоростью развития процессов в анализируемой системе: 
	
Данная задача построения алгоритма распознавания соответствует классической постановке задачи обучения по прецедентам [5]. Для случая, когда для траекторий из выборки  известны отсчеты начала и окончания участков нештатного поведения, разработаны алгоритмы решения сформулированной задачи, см. [6]. В работе [6] так же приводятся результаты сравнительного исследования алгоритмов на основе алгебраического подхода с другими широко применяемым алгоритмами решения сформулированной задачи. 
В данной работе рассматривается случай, когда для траекторий из выборки  известны только точки наступления аварийных состояний, а границы предшествующих участков нештатного поведения неизвестны. Для того, чтобы найти требуемый алгоритм распознавания в семействе , необходимо выбрать алгоритм предобработки и значение его параметров, построить систему аксиом, выбрать алгоритм нечеткого поиска и значение его параметров, определить эталоны участков нештатного поведения, которые необходимо обнаруживать в наблюдаемой фазовой траектории системы. Поиск алгоритма распознавания ведется в два этапа:  
1. Для каждой пары (алгоритм предобработки, алгоритм поиска разметок) ведется поиск алгоритма распознавания. Область поиска с заданным типом алгоритма предобработки и типом алгоритма поиска разметок будем называть шаблоном и обозначать .  При этом, для алгоритма распознавания настраиваются значения параметров заданных алгоритмов предобработки и поиска разметок, стоится система аксиом и формируются разметки участков нештатного поведения. 
2. Среди всех полученных решений выбирается то, которое показывает наименьшее значение целевой функции  на контрольной выборке . 
 Для настроек параметров алгоритмов предобработки и поиска разметок используются алгоритмы локальной оптимизации, в частности алгоритм градиентного спуска. Наибольшую сложность представляет задача построения системы аксиом и формирования разметок участков нештатного поведения. Решение этой задачи будет рассмотрено ниже.


4. Алгоритм построения системы аксиом

Алгоритм построения системы аксиом состоит в следующем: 
1. Для каждого класса  нештатного поведения системы производится построение элементарных условий и аксиом, которые выполняются на участках нештатного поведения именно этого класса. Для этого выполняется: 
a. Составление сокращенной обучающей выборки  из траекторий выборки , содержащих участки нештатного поведения класса , и траекторий нормального поведения из . Таким образом, из  в  попадают все траектории, кроме траекторий, содержащих участки нештатного поведения, не относящиеся к классу  нештатного поведения системы.  
b. Выбор элементарных условий и настройка их параметров. На этом этапе выбираются множество таких элементарных условий с заданными параметрами, которые чаще выполняются на траекториях, содержащих участки нештатного поведения класса , и реже на траекториях нормального поведения из обучающей выборки. Для этого происходит:
i. Создание набора из  элементарных условий, в который включаются все заданные условия вместе с их отрицаниями:  
		
	Для того, чтобы учесть, что некоторое элементарное условие  с определенным набором параметров может выполняться на участках нормального поведения и не выполняться на участках нештатного поведения, в набор  включаются все элементарные условия с отрицаниями.
ii. Для каждого элементарного условия  из набора  определяется область значений его параметров, при которых условие  принимает значение . В полученной области строится сетка значений параметров  с заданным шагом  по каждому из параметров  условия .
iii. Заданное количество  элементарных условий с определенными значениями параметров, которые чаще выполняются на траекториях, содержащих участки нештатного поведения класса , и реже на траекториях нормального поведения, сохраняются и представляют собой результат работы данного этапа алгоритма. 
c. Формирование аксиом из выбранных элементарных условий. Лучшие аксиомы, которые чаще выполняются на траекториях, содержащих участки нештатного поведения класса , и реже на траекториях нормального поведения, сохраняются и поступают на вход следующему этапу алгоритма:
i. Для каждого элементарного условия , выбранного ранее, создается аксиома , состоящая только из данного условия:  
	 ,  	
ii. Итеративное изменение набора аксиом .   Для каждой пары различных аксиом  и  в наборе  строется две новые аксиомы:  
	,  	
Если новая аксиома чаще выполняются на траекториях, содержащих участки нештатного поведения класса , и реже на траекториях нормального поведения, по сравнению с  и , то она добавляется в .
iii. Сокращение числа аксиом в  до заданного параметра , причем, сохраняются те аксиомы, которые чаще выполняются на траекториях, содержащих участки нештатного поведения класса , и реже на траекториях нормального поведения. 
iv. Если множество  не было обновлено на шаге ii или достигнуто заданное число итераций данного алгоритма, то происходит переход на этап 2 алгоритма. В противном случае – переход на шаг ii.
2. Формирование множества систем аксиом из построенных аксиом:
a. Для каждой аксиомы  создается система аксиом:  
	 ,  
b. Для каждой системы аксиом  из множества  запускается итеративный процесс ее дополнения аксиомами из набора :
i. Для системы  создается система аксиом  путем добавления аксиомы  c наименьшим приоритетом:  
	
ii. Для каждой построенной системы аксиом  формируются разметки эталонных траекторий для всех классов нештатного поведения. Эти разметки получаются из выборки  путем выделения наибольшей общей подпоследовательности разметок траекторий, содержащих участки нештатного поведения одного класса, относительно системы аксиом . 
iii. Для каждой построенной системы аксиом  вычисляется значение целевой функции  на обучающей выборке . Если значение  для  оказалось меньше, чем для , то  помещается в .
iv. Система  переходит из  в .
v. Если оказалось пусто или число итераций алгритма превысило заданный параметр, то происходит переход на этап 3, иначе – на шаг 2.b.
3. Выбор лучшей системы аксиом  по значению целевой функции  на контрольной выборке  среди всех систем аксиом в наборе . Выбранная система аксиом  является результатом работы алгоритма.
Основной особенностью предложенного алгоритма построения системы аксиом является то, что алгоритм позволяет выделять разметки участков нештатного поведения, используемые как разметки эталонных траекторий. Предложенный способ выделения разметок основан на том, что на этапах построения элементарных условий и аксиом формировались такие условия и такие аксиомы, которые выполняются на участках нештатного поведения и не выполняются на траекториях нормального поведения.


5. Результаты численного исследования 
 
Исследования показали, что предложенный метод позволяет получать алгоритмы распознавания, устойчивые к искажениям участков нештатного поведения по амплитуде и времени относительно эталонных траекторий. При искажениях по времени до 20% и амплитуде до 20% и при амплитуде шума в 5% от амплитуды сигнала были получены следующие результаты: число I первого рода – 51 (при длине анализируемой траектории в 30000 отсчетов), процент ошибок II рода – 8.5%. При искажениях по времени до 20% и амплитуде до 2.5% и при амплитуде шума в 15% от амплитуды сигнала получены следующие значения ошибок распознавания: 30 ошибок I рода (при длине анализируемой траектории в 30000 отсчетов) и 6% ошибок II рода.
Кроме того, проводилось исследование изложенного в работе подхода для решения практических задач. Среди них: прогнозирование микросна водителя, распознавание рукописного ввода букв, распознавания звуков и др. Были получены алгоритмы распознавания, демонстрирующие низкое число ошибок распознавания. Например, результаты алгоритма прогнозирования микрона водителя: в среднем, процент ошибок II рода составил 5%, а число ложных срабатываний в среднем составило около 15 на  отсчетов (что соответствует 6–7 часам наблюдения). Для задачи распознавания рукописного ввода букв были получены следующие результаты: число корректно распознанных букв составило 95%, число ложных срабатываний – 58 при общем числе траекторий – 2858.

6. Заключение

Результаты численного исследования свидетельствуют о том, что разработанные методы построения алгоритмов распознавания позволяют получать алгоритмы, обладающие высокой устойчивостью к нелинейным искажениям фазовых траекторий нештатного поведения по амплитуде и времени и, потому, могут быть использованы при проектировании и эксплуатации сложных систем, требующих автоматического контроля своего состояния. Разработанные методы в отличии от известных методов основанных на машинном обучении позволяют строить алгоритмы распознавания нештатного поведения систем для случая, когда время возникновения неисправности в системе неизвестно, т.е в траекториях обучающей выборки не указаны участки нештатного поведения, а указана лишь точка наступления аварии.


Список литературы

1. Рудаков К. В., Чехович Ю. В. О проблеме синтеза обучающих алгоритмов выделения трендов (алгебраический подход). // Прикладная математика и информатика N 8, М. Издательство факультета ВМиК МГУ, 2001. С. 97-114. 
2. Коваленко Д. С., Костенко В. А., Васин Е. А. Исследование применимости алгебраического подхода к анализу временных рядов. // Труды Второй Всероссийской Научной Конференции «Методы и средства обработки информации». Изд.: ВМиК МГУ, 2005. С. 553-559. 
3. Keogh E. J., Michael J. Pazzani Derivative Dynamic Time Warping. // Proceedings of the First SIAM International Conference on Data Mining (SDM'2001), Chicago, USA. 2001. http://www.ics.uci.edu/ pazzani/Publications/sdm01.pdf. 
4. Коваленко Д. С. Методы нечеткого сравнения и голосования для построения распознавателей нештатного поведения динамических систем.  // Труды V Московской международной конференции по исследованию операций «ORM-2007». Изд: МАКС Пресс, 2007. С.123-125. 
5. Воронцов К. В. Комбинаторный подход к оценке качества обучаемых алгоритмов. // Математические вопросы кибернетики. №13, 2004. С.5-36. http://www.ccas.ru/frc/papers/voron04mpc.pdf 
6. Барыбин А.К., Коваленко Д.С., Костенко В.А, Тумакин Д.А., Чельдиев М.И. Параллельный алгоритм обучения распознавателей нештатного поведения динамических систем. // Труды Третьей Всероссийской Научной Конференции «Методы и средства обработки информации», МСО-2009. Изд.: МАКС Пресс. С. 362-373. 